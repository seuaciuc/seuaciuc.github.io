<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>CS416 Summer 2023: Narrative Visualization</title>
    </head>
    <script src='https://d3js.org/d3.v5.min.js'></script>
    <!--<style> circle {fill: lightblue; stroke: black;} </style>-->
    <style>
      #tooltip {
        opacity:0;
        position:absolute;
        text-align:left;
        width: 200px; height: 80px;
        background: white;
        border: 0px;
        left: 280px;
        top: 460px;
      }
      #note {
        opacity:1;
        position:absolute;
        text-align:left;
        width: 200px; height: 80px;
        background: white;
        color: gray;
        border: 0px;
        left: 280px;
        top: 460px;
      }
    </style>
    
 <!--   <body onload='init()'> -->
    <body>

        <h1>The 2017 Car Market from a Fuel Economy Perspective</h1>

        <p>trying selection on legend</p>
        
        <div id="tooltip"></div>
        <div id="note"></div>
        <svg width=500 height=650>
        </svg>
        <script>
          //  async function init() {
                // data
                var citympg = [12,12,13,12,10,13,12,14,12,14,17,13,15,14,15,15,15,16,15,14,16,14,15,15,15,15,15,14,13,15,14,16,14,16,16,14,14,14,14,13,21,17,19,23,19,18,17,18,17,20,18,11,17,17,17,17,19,18,20,18,19,17,18,22,17,21,20,16,17,16,19,20,18,18,19,17,20,20,18,25,24,23,24,30,23,20,23,22,22,21,21,27,23,19,26,22,19,24,21,20,30,29,27,22,25,30,21,24,21,27,20,22,39,23,26,27,23,24,24,26,26,21,21,21,25,23,32,21,24,22,23,28,29,35,32,36];
                var hwympg = [19,20,20,16,17,20,19,22,19,21,26,22,23,21,21,23,21,25,24,23,22,21,22,23,21,22,23,22,19,23,19,22,20,23,22,20,21,21,23,18,28,24,27,29,28,26,25,26,24,29,27,18,23,24,27,23,28,25,27,26,27,22,25,28,23,28,28,24,24,24,25,27,26,25,26,24,28,25,25,35,33,30,32,41,32,27,31,30,32,29,31,34,36,25,34,30,25,31,29,27,38,37,34,30,27,39,30,31,27,33,27,30,36,29,34,35,30,33,31,31,33,27,28,27,33,30,35,28,33,29,32,29,40,42,39,33];
                var cyl = [12,12,12,12,12,12,12,10,10,10,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,2];
                var continent = ["Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","North America","Europe","Europe","Europe","Europe","North America","North America","North America","North America","North America","North America","North America","Europe","North America","North America","Asia","North America","Asia","Europe","North America","North America","Asia","Europe","Asia","Europe","Europe","Europe","Asia","Europe","North America","North America","Asia","Asia","Europe","Europe","Europe","Europe","North America","North America","North America","North America","North America","North America","North America","North America","Asia","Asia","North America","Asia","Asia","Asia","Europe","North America","North America","Asia","Europe","Europe","Asia","Asia","North America","Europe","Europe","Europe","Asia","Asia","Asia","Europe","North America","Asia","Asia","Europe","Asia","Europe","Europe","Europe","Europe","Europe","North America","North America","North America","North America","North America","North America","North America","North America","North America","Europe","Europe","North America","North America","North America","North America","Asia","Asia","Asia","Asia","Asia","Europe","Europe","North America","North America","Asia","Europe","Asia","Asia","North America","Asia","Asia","Europe","Europe","Asia","Asia","Asia","Europe","North America","Asia","Asia","Asia","Asia","Europe","Europe","Europe","Europe","Europe","North America","Asia","Europe","Europe"];
                var make = ["Aston Martin","Bentley","BMW","Ferrari","Lamborghini","Mercedes-Benz","Rolls-Royce","Audi","Dodge","Lamborghini","Audi","Bentley","BMW","Cadillac","Cadillac","Chevrolet","Chevrolet","Chrysler","Dodge","Dodge","Ferrari","Ford","Ford","Genesis","GMC","Infiniti","Jaguar","Jeep","Jeep","Kia","Land Rover","Lexus","Maserati","McLaren Automotive","Mercedes-Benz","Nissan","Porsche","Ram","Roush Performance","Toyota","Acura","Alfa Romeo","Audi","BMW","BMW","Buick","Cadillac","Cadillac","Chevrolet","Chrysler","Dodge","Ford","Ford","Genesis","Genesis","GMC","Honda","Hyundai","Infiniti","Jaguar","Jeep","Jeep","Kia","Land Rover","Land Rover","Lexus","Lexus","Lincoln","Lotus","Maserati","Mercedes-Benz","Mitsubishi","Nissan","Nissan","Porsche","Ram","Subaru","Toyota","Volkswagen","Acura","Alfa Romeo","Audi","Audi","BMW","BMW","Buick","Buick","Cadillac","Cadillac","Chevrolet","Chevrolet","Chevrolet","Chrysler","Dodge","Fiat","Fiat","Ford","Ford","GMC","GMC","Honda","Honda","Hyundai","Infiniti","Infiniti","Jaguar","Jaguar","Jeep","Jeep","Kia","Land Rover","Lexus","Lexus","Lincoln","Mazda","Mazda","Mercedes-Benz","MINI","Mitsubishi","Nissan","Nissan","Porsche","Ram","Subaru","Subaru","Toyota","Toyota","Volkswagen","Volkswagen","Volvo","Volvo","BMW","Ford","Mitsubishi","smart","BMW"];
                var country = ["England","England","Germany","Italy","Italy","Germany","England","Germany","USA","Italy","Germany","England","Germany","USA","USA","USA","USA","USA","USA","USA","Italy","USA","USA","South Korea","USA","Japan","England","USA","USA","South Korea","England","Japan","Italy","England","Germany","Japan","Germany","USA","USA","Japan","Japan","Italy","Germany","Germany","Germany","USA","USA","USA","USA","USA","USA","USA","USA","South Korea","South Korea","USA","Japan","South Korea","Japan","England","USA","USA","South Korea","England","England","Japan","Japan","USA","England","Italy","Germany","Japan","Japan","Japan","Germany","USA","Japan","Japan","Germany","Japan","Italy","Germany","Germany","Germany","Germany","USA","USA","USA","USA","USA","USA","USA","USA","USA","Italy","Italy","USA","USA","USA","USA","Japan","Japan","South Korea","Japan","Japan","England","England","USA","USA","South Korea","England","Japan","Japan","USA","Japan","Japan","Germany","England","Japan","Japan","Japan","Germany","USA","Japan","Japan","Japan","Japan","Germany","Germany","Sweden","Sweden","Germany","USA","Japan","Germany","Germany"];
                var fuel = ["Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Diesel","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Diesel","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Diesel","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Diesel","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Diesel","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Diesel","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline","Gasoline"];

                //plot setup
                var xo = 50
                var yo = 50
                var H = 400
                var W = 400
                var xmin = 5
                var xmax = 50
                var ymin = 10
                var ymax = 50

                var tooltip = d3.select('#tooltip');
                var note = d3.select('#note')
                             .html("Hover any point to see<br>more information here.")

                x = d3.scaleLinear().domain([xmin,xmax]).range([0,H]);
                y = d3.scaleLinear().domain([ymin,ymax]).range([W,0]);
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .selectAll('circle')
                  .data(citympg)
                  .enter()
                  .append('circle')
                    .attr('cx',function(d,i){return x(citympg[i]);})
                    .attr('cy',function(d,i){return y(hwympg[i]);})
                    .attr('r',function(d,i){if(cyl[i]<=4){return 4;}else if(cyl[i]==6){return 8;}else{return 12;};})//{return 2+cyl[i];})
                    .style('fill',function(d,i){if(continent[i]=="Asia"){return "rgb(255,0,0)";}else if(continent[i]=="Europe"){return "rgb(0,255,0)";}else{return "rgb(0,0,255)";}})
                    //.style('stroke','black')
                    .on("mouseover",function(d,i){tooltip.style("opacity",1)
                                                         .html("<b>Make:</b> "+make[i]+"<br><b>Fuel:</b> "+fuel[i]+"<br><b>Cylinders:</b> "+cyl[i]+"<br><b>City MPG:</b> "+citympg[i]+"<br><b>Highway MPG:</b> "+hwympg[i]);
                                                  d3.select(this).style('stroke','black');
                                                  note.style("opacity",0)
                                                 })
                    .on("mouseout",function(){tooltip.style("opacity",0);d3.select(this).style('stroke','none');note.style("opacity",1);})
                
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .call(d3.axisLeft(y).tickValues([10,20,30,40,50]).tickFormat(d3.format("~s")))
                  
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,450)")
                  .call(d3.axisBottom(x).tickValues([10,20,30,40,50]).tickFormat(d3.format("~s")))
/*
                // box around chart

                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('line')
                    .attr('x0',W)
                    .attr('y0',0)
                    .attr('x1',W)
                    .attr('y1',H)
                    .style('stroke','rgb(0,0,0)')

                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('line')
                    .attr('x0',0)
                    .attr('y0',0)
                    .attr('x1',W)
                    .attr('y1',0)
                    .style('stroke','rgb(0,0,0)')
                                                       
                
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('rect')
                    .attr('x',0)
                    .attr('y',0)
                    .attr('width',W)
                    .attr('height',H)
                    .style('stroke','rgb(0,0,0)')
                    .style('fill','none')
 
                
                // explanatory note on graph
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append("text")
                    .attr("text-anchor", "top")
                    .attr("x", 240)
                    .attr("y", 310)
                    .text("Hover any point to see\nmore information here.")
                    .style('fill','rgb(150,150,150)');
*/
                // axis titles
                // Add X axis label:
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append("text")
                    .attr("text-anchor", "middle")
                    .attr("x", 200)
                    .attr("y", 440)
                    .text("Average City Miles per Gallon");

                // Y axis label:
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append("text")
                    .attr("text-anchor", "end")
                    .attr("transform", "rotate(-90)")
                    .attr("x", -88)
                    .attr("y", -30)
                    .text("Average Highway Miles per Gallon")
                    
                // adding legends
                // Continent legend title
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('text')
                    .attr('x',0)
                    .attr('y',475)
                    .text('Continent')
                    .attr("font-weight",700)
                    .style("font-size", "20px")
                // red legend entry
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('circle')
                    .attr('cx',0)
                    .attr('cy',500)
                    .attr('r',8)
                    .style('fill','rgb(255,0,0)')
                    .on("mouseover",function(){d3.selectAll("circle[fill='rgb(255,0,0)']").style('opacity',0.5)})
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('text')
                    .attr('x',20)
                    .attr('y',500)
                    .text('Asia')
                    .attr("alignment-baseline","middle")
                    .style('fill','rgb(255,0,0)')
                // green legend entry
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('circle')
                    .attr('cx',0)
                    .attr('cy',525)
                    .attr('r',8)
                    .style('fill','rgb(0,255,0)')
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('text')
                    .attr('x',20)
                    .attr('y',525)
                    .text('Europe')
                    .attr("alignment-baseline","middle")
                    .style('fill','rgb(0,255,0)')
                // blue legend entry
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('circle')
                    .attr('cx',0)
                    .attr('cy',550)
                    .attr('r',8)
                    .style('fill','rgb(0,0,255)')
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('text')
                    .attr('x',20)
                    .attr('y',550)
                    .text('North America')
                    .attr("alignment-baseline","middle")
                    .style('fill','rgb(0,0,255)')
                // Engine size legend title
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('text')
                    .attr('x',200)
                    .attr('y',475)
                    .text('Engine Size')
                    .attr("font-weight",700)
                    .style("font-size", "20px")
                // size 4 legend entry
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('circle')
                    .attr('cx',200)
                    .attr('cy',500)
                    .attr('r',4)
                    .style('fill','rgb(100,100,100)')
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")  
                  .append('text')
                    .attr('x',220)
                    .attr('y',500)
                    .text('4 or fewer cylinders')
                    .attr("alignment-baseline","middle")
                // size 8 legend entry
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('circle')
                    .attr('cx',200)
                    .attr('cy',525)
                    .attr('r',8)
                    .style('fill','rgb(100,100,100)')
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('text')
                    .attr('x',220)
                    .attr('y',525)
                    .text('8 cylinders')
                    .attr("alignment-baseline","middle")
                // size 12 legend entry
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('circle')
                    .attr('cx',200)
                    .attr('cy',550)
                    .attr('r',12)
                    .style('fill','rgb(100,100,100)')
                d3.select('svg')
                  .append("g")
                  .attr("transform","translate(50,50)")
                  .append('text')
                    .attr('x',220)
                    .attr('y',550)
                    .text('10 or more cylinders')
                    .attr("alignment-baseline","middle")
                
                
                
               // }
            </script>
    </body>
</html>
